{% extends "base.html" %}

{% block title %}Comprar Sistema Mega Sena - Checkout{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg">
                <div class="card-header bg-success text-white text-center">
                    <h3 class="mb-0">Finalizar Compra</h3>
                </div>
                <div class="card-body p-4">
                    <!-- Resumo do Produto -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <h5>Sistema Mega Sena IA</h5>
                            <p class="text-muted">Acesso vitalício ao sistema de análise inteligente</p>
                            <ul class="list-unstyled">
                                <li>✅ Análise Inteligente com IA</li>
                                <li>✅ Resultados Rápidos</li>
                                <li>✅ Fácil de Usar</li>
                                <li>✅ Suporte 24/7</li>
                                <li>✅ Atualizações Gratuitas</li>
                            </ul>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="mb-2">
                                <span class="text-decoration-line-through text-muted">R$ 130,00</span>
                            </div>
                            <div class="h3 text-success mb-0">R$ 50,00</div>
                            <small class="text-muted">Pagamento único</small>
                        </div>
                    </div>

                    <!-- Formulário de Pagamento -->
                    <form id="checkoutForm" action="/api/purchase" method="POST">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="nome" class="form-label">Nome Completo *</label>
                                <input type="text" class="form-control" id="nome" name="nome" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label">E-mail *</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="telefone" class="form-label">Telefone</label>
                                <input type="tel" class="form-control" id="telefone" name="telefone">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="cpf" class="form-label">CPF</label>
                                <input type="text" class="form-control" id="cpf" name="cpf">
                            </div>
                        </div>

                        <!-- Informações de Pagamento -->
                        <div class="border-top pt-4 mb-4">
                            <h6>Informações de Pagamento</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="card_number" class="form-label">Número do Cartão *</label>
                                    <input type="text" class="form-control" id="card_number" name="card_number" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="expiry" class="form-label">Validade *</label>
                                    <input type="text" class="form-control" id="expiry" name="expiry" placeholder="MM/AA" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="cvv" class="form-label">CVV *</label>
                                    <input type="text" class="form-control" id="cvv" name="cvv" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12 mb-3">
                                    <label for="card_name" class="form-label">Nome no Cartão *</label>
                                    <input type="text" class="form-control" id="card_name" name="card_name" required>
                                </div>
                            </div>
                        </div>

                        <!-- Termos e Condições -->
                        <div class="mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="terms" required>
                                <label class="form-check-label" for="terms">
                                    Li e aceito os <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">termos e condições</a> *
                                </label>
                            </div>
                        </div>

                        <!-- Botão de Pagamento -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-success btn-lg">
                                <i class="fas fa-lock me-2"></i>
                                Finalizar Compra - R$ 50,00
                            </button>
                        </div>

                        <!-- Informações de Segurança -->
                        <div class="text-center mt-3">
                            <small class="text-muted">
                                <i class="fas fa-shield-alt me-1"></i>
                                Pagamento seguro via SSL
                            </small>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Garantia -->
            <div class="card mt-4">
                <div class="card-body text-center">
                    <h6>✅ Garantia de 30 Dias</h6>
                    <p class="mb-0">Se não ficar satisfeito, devolvemos 100% do seu dinheiro em até 30 dias.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Termos e Condições -->
<div class="modal fade" id="termsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Termos e Condições</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>1. Produto</h6>
                <p>O Sistema Mega Sena IA é uma ferramenta de análise estatística que utiliza inteligência artificial para sugerir combinações para apostas na Mega Sena.</p>
                
                <h6>2. Acesso</h6>
                <p>O acesso é vitalício e inclui todas as atualizações futuras do sistema.</p>
                
                <h6>3. Garantia</h6>
                <p>Oferecemos garantia de 30 dias. Se não ficar satisfeito, devolvemos 100% do valor pago.</p>
                
                <h6>4. Responsabilidade</h6>
                <p>O sistema é uma ferramenta de análise e não garante vitórias. Apostas envolvem risco.</p>
                
                <h6>5. Suporte</h6>
                <p>Oferecemos suporte por email e WhatsApp durante o horário comercial.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('checkoutForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Mostrar loading
    const button = this.querySelector('button[type="submit"]');
    const originalText = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processando...';
    button.disabled = true;
    
    // Simular processamento
    setTimeout(() => {
        // Aqui você integraria com gateway de pagamento real
        alert('Compra processada com sucesso! Você receberá o acesso por email.');
        window.location.href = '/dashboard';
    }, 2000);
});

// Máscara para campos
document.getElementById('cpf').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    value = value.replace(/(\d{3})(\d)/, '$1.$2');
    value = value.replace(/(\d{3})(\d)/, '$1.$2');
    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
    e.target.value = value;
});

document.getElementById('telefone').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    value = value.replace(/(\d{2})(\d)/, '($1) $2');
    value = value.replace(/(\d{5})(\d)/, '$1-$2');
    e.target.value = value;
});

document.getElementById('card_number').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    value = value.replace(/(\d{4})(\d)/, '$1 $2');
    value = value.replace(/(\d{4})(\d)/, '$1 $2');
    value = value.replace(/(\d{4})(\d)/, '$1 $2');
    e.target.value = value;
});

document.getElementById('expiry').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    value = value.replace(/(\d{2})(\d)/, '$1/$2');
    e.target.value = value;
});
</script>
{% endblock %} 